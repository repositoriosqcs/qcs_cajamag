
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../1.5-FactDatosContacto/">
      
      
        <link rel="next" href="../1.7-Fact_Historico_Trabajadores1/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>1.6 Fact Historico Afiliacion Empresas - Optimización CAJAMAG - Gobierno de Datos</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="#d89717" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#16-fact-historico-afiliacion-empresas" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Optimización CAJAMAG - Gobierno de Datos" class="md-header__button md-logo" aria-label="Optimización CAJAMAG - Gobierno de Datos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Optimización CAJAMAG - Gobierno de Datos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1.6 Fact Historico Afiliacion Empresas
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Optimización CAJAMAG - Gobierno de Datos" class="md-nav__button md-logo" aria-label="Optimización CAJAMAG - Gobierno de Datos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Optimización CAJAMAG - Gobierno de Datos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INTRODUCCIÓN
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../instalacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INSTALACIÓN Y CONFIGURACIÓN
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../buenaspracticas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BUENAS PRACTICAS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codigo/funciones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FUNCIONES
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    BODEGAS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            BODEGAS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1. Bodega 1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            1. Bodega 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.1-DimDatosFijos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1 DimDatosFijos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.2-DimCalendarioMensual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 DimCalendarioMensual
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.3-Dimensiones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Dimensiones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.4-Dimensiones_xml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4 Dimensiones xml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.5-FactDatosContacto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5 FactDatosContacto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    1.6 Fact Historico Afiliacion Empresas
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    1.6 Fact Historico Afiliacion Empresas
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introducción">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagrama-de-secuencia-del-proceso-etl" class="md-nav__link">
    <span class="md-ellipsis">
      Diagrama de Secuencia del Proceso ETL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#etl" class="md-nav__link">
    <span class="md-ellipsis">
      ETL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ETL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importacion-de-librerias-y-funciones" class="md-nav__link">
    <span class="md-ellipsis">
      Importación de librerías y funciones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracion-del-logger-y-comienzo-del-proceso-etl" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración del logger y comienzo del proceso ETL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consulta-sql-para-consolidacion-de-datos-de-empresas-y-trabajadores" class="md-nav__link">
    <span class="md-ellipsis">
      Consulta SQL para Consolidación de Datos de Empresas y Trabajadores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consulta-sql-para-consolidacion-de-datos-de-empresas-con-segmentacion-por-periodo" class="md-nav__link">
    <span class="md-ellipsis">
      Consulta SQL para Consolidación de Datos de Empresas con Segmentación por Periodo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conexion-a-bases-de-datos-y-carga-de-tablas" class="md-nav__link">
    <span class="md-ellipsis">
      Conexión a Bases de Datos y Carga de Tablas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estandarizacion-y-creacion-de-identificadores-unicos-en-datos-de-empresas" class="md-nav__link">
    <span class="md-ellipsis">
      Estandarización y Creación de Identificadores Únicos en Datos de Empresas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#almacenamiento-de-datos-en-el-data-warehouse" class="md-nav__link">
    <span class="md-ellipsis">
      Almacenamiento de Datos en el Data Warehouse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.7-Fact_Historico_Trabajadores1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.7 Fact Historico Trabajadores1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.7-Fact_Historico_Trabajadores2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.7 Fact Historico Trabajadores2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.8-Fact_HistoricoBeneficiarios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.8 Fact HistoricoBeneficiarios
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.9-Dim_Parametricas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.9 Dim Parametricas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2. Bodega 2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            2. Bodega 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1-FactAportesEmpAfiliadas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 FactAportesEmpAfiliadas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1-FactHistoricoAportesTotales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 FactHistoricoAportesTotales
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2-FactHistoricoCuota/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 FactHistoricoCuota
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.3-FactSubsidioVivienda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3 FactSubsidioVivienda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.4-FactFosfec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4 FactFosfec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2-FactEstadoGiroCuota/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 FactEstadoGiroCuota
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.5-Fact_HistoricoMoraEmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.5 Fact HistoricoMoraEmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.6-FactHistoricoANS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.6 FactHistoricoANS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.7-FactHistoricoSubPrescrito/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.7 FactHistoricoSubPrescrito
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.8-FactHistoricoRecobro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.8 FactHistoricoRecobro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.9-FactHistoricoRecuperado/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.9 FactHistoricoRecuperado
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.10-FactIgestion_Mercurio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.10 FactIgestion Mercurio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3. Bodega 3
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            3. Bodega 3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.1-FactTransaccionesVentas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 FactTransaccionesVentas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    4. Bodega 4
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            4. Bodega 4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.1-FactColegio_fijos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 FactColegio fijos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.2-FactColegio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 FactColegio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    5. Bodega 5
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            5. Bodega 5
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.1-FactServicioSocial_Fijos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 FactServicioSocial Fijos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.2-FactServicioSocial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 FactServicioSocial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    6. Bodega 6
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            6. Bodega 6
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.1-FactEncuestas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 FactEncuestas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.2-Fact_Encuesta_afil_empleador/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 Fact Encuesta afil empleador
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introducción">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagrama-de-secuencia-del-proceso-etl" class="md-nav__link">
    <span class="md-ellipsis">
      Diagrama de Secuencia del Proceso ETL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#etl" class="md-nav__link">
    <span class="md-ellipsis">
      ETL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ETL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importacion-de-librerias-y-funciones" class="md-nav__link">
    <span class="md-ellipsis">
      Importación de librerías y funciones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracion-del-logger-y-comienzo-del-proceso-etl" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración del logger y comienzo del proceso ETL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consulta-sql-para-consolidacion-de-datos-de-empresas-y-trabajadores" class="md-nav__link">
    <span class="md-ellipsis">
      Consulta SQL para Consolidación de Datos de Empresas y Trabajadores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consulta-sql-para-consolidacion-de-datos-de-empresas-con-segmentacion-por-periodo" class="md-nav__link">
    <span class="md-ellipsis">
      Consulta SQL para Consolidación de Datos de Empresas con Segmentación por Periodo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conexion-a-bases-de-datos-y-carga-de-tablas" class="md-nav__link">
    <span class="md-ellipsis">
      Conexión a Bases de Datos y Carga de Tablas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estandarizacion-y-creacion-de-identificadores-unicos-en-datos-de-empresas" class="md-nav__link">
    <span class="md-ellipsis">
      Estandarización y Creación de Identificadores Únicos en Datos de Empresas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#almacenamiento-de-datos-en-el-data-warehouse" class="md-nav__link">
    <span class="md-ellipsis">
      Almacenamiento de Datos en el Data Warehouse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="16-fact-historico-afiliacion-empresas">1.6 Fact Historico Afiliacion Empresas<a class="headerlink" href="#16-fact-historico-afiliacion-empresas" title="Permanent link">&para;</a></h1>
<h2 id="introduccion">Introducción<a class="headerlink" href="#introduccion" title="Permanent link">&para;</a></h2>
<p>En este proceso ETL se consolidan y transforman datos relacionados con la afiliación de empresas y sus empleados, para ser almacenados en una tabla de hechos dentro del Data Warehouse (DWH), denominada <code>BD_Fact_Historico_Afiliacion_Empresas</code>. Se extrajeron datos desde las tablas <code>xml4c085</code> y <code>op_EmpresasSubsi02_v2</code>, que incluyen información detallada sobre el estado de afiliación de las empresas, así como la cantidad de trabajadores, su distribución por género, y otros detalles relacionados con el código de documento y zonas geográficas. Estos datos permitieron analizar el comportamiento histórico de afiliación, identificar periodos de ingreso y retiro, y consolidar información demográfica clave de las empresas afiliadas.</p>
<p>La salida final, <code>BD_Fact_Historico_Afiliacion_Empresas</code>, almacena estos datos, permitiendo analizar el estado de las empresas afiliadas en diferentes periodos, el número de empleados y la distribución por género. El proceso incluyó la limpieza de datos, la estandarización de nombres de columnas, y la creación de identificadores únicos para los registros de empresas y sus empleados.</p>
<hr />
<h3 id="diagrama-de-secuencia-del-proceso-etl">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>sequenceDiagram
title Diagrama de Secuencia del Proceso ETL para Afiliación de Empresas
autonumber
participant 👤 Usuario
participant Script as Script ETL
participant DB as Bases de Datos
participant DWH as Data Warehouse

Usuario-&gt;&gt;Script: Solicitar ETL de Histórico de Afiliación
Script-&gt;&gt;DB: Conectar y extraer datos de &lt;br&gt; xml4c085, op_EmpresasSubsi02_v2
DB--&gt;&gt;Script: Retornar datos extraídos
Script-&gt;&gt;Script: Limpiar, estandarizar y transformar los datos
Script-&gt;&gt;DWH: Cargar datos en BD_Fact_Historico_Afiliacion_Empresas
DWH--&gt;&gt;Script: Confirmación de carga exitosa
Script--&gt;&gt;Usuario: Proceso ETL completado con éxito</code></pre>
<p>Este diagrama muestra las diferentes etapas del proceso ETL, desde la extracción de los datos de las bases hasta la consolidación de la información en el DWH, lo cual facilita el análisis del comportamiento de afiliación de las empresas y sus empleados.</p>
<h2 id="etl">ETL<a class="headerlink" href="#etl" title="Permanent link">&para;</a></h2>
<h3 id="importacion-de-librerias-y-funciones">Importación de librerías y funciones<a class="headerlink" href="#importacion-de-librerias-y-funciones" title="Permanent link">&para;</a></h3>
<p>Este script facilita el manejo y la transformación de datos en una base de datos usando SQLAlchemy y Pandas, complementado con funciones personalizadas que optimizan el flujo de trabajo. Con SQLAlchemy, se gestiona la conexión a bases de datos mediante <code>create_engine</code>, y Pandas permite la manipulación de datos en formato tabular, incluyendo transformaciones y almacenamiento. La biblioteca <code>time</code> mide la duración de la ejecución para monitoreo de rendimiento, mientras que <code>logging</code> permite la captura de eventos importantes y posibles errores. Desde el módulo <code>Funciones.py</code>, se importan funciones clave como <code>convertir_columnas_mayusculas</code> (posiblemente para estandarizar los nombres de las columnas), <code>guardar_en_dwh</code> (para almacenar datos en un Data Warehouse), <code>cargar_tablas</code> (para cargar datos desde diversas fuentes), <code>obtener_conexion</code> (para establecer una conexión), <code>testfunciones</code> (posiblemente para pruebas), y <code>setup_logger</code> (para configurar el sistema de logging). Este enfoque modular asegura un procesamiento de datos flexible y escalable para flujos ETL o análisis.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sa</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1">#Import de modulo funciones</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Agrega el directorio al sys.path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../funciones&#39;</span><span class="p">))</span>

<span class="c1"># Importa las funciones desde el archivo Funciones.py</span>

<span class="kn">from</span> <span class="nn">Funciones</span> <span class="kn">import</span> <span class="n">convertir_columnas_mayusculas</span><span class="p">,</span> <span class="n">guardar_en_dwh</span><span class="p">,</span> <span class="n">cargar_tablas</span><span class="p">,</span> <span class="n">obtener_conexion</span><span class="p">,</span> <span class="n">testfunciones</span><span class="p">,</span> <span class="n">setup_logger</span>
</code></pre></div>
<h3 id="configuracion-del-logger-y-comienzo-del-proceso-etl">Configuración del logger y comienzo del proceso ETL<a class="headerlink" href="#configuracion-del-logger-y-comienzo-del-proceso-etl" title="Permanent link">&para;</a></h3>
<p>En esta celda se configura el logger, que se utiliza para registrar mensajes de información (logging). El logger está configurado para guardar un archivo log con el nombre <code>Empresas.log</code>, y en esta etapa, se inicia el proceso ETL, registrando el comienzo del mismo.</p>
<hr />
<div class="highlight"><pre><span></span><code><span class="c1">#---------------------------------------------</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">setup_logger</span><span class="p">(</span><span class="n">log_filename</span><span class="o">=</span><span class="s1">&#39;Empresas.log&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>  <span class="c1"># Cambiado a logging.INFO</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">testfunciones</span><span class="p">())</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;COMIENZO ETL&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-30 11:48:51,409 - INFO - Importacion de funciones correcta, 30-10-2024 11:48
2024-10-30 11:48:51,411 - INFO - COMIENZO ETL
</code></pre></div>

<h3 id="consulta-sql-para-consolidacion-de-datos-de-empresas-y-trabajadores">Consulta SQL para Consolidación de Datos de Empresas y Trabajadores<a class="headerlink" href="#consulta-sql-para-consolidacion-de-datos-de-empresas-y-trabajadores" title="Permanent link">&para;</a></h3>
<p>Esta consulta SQL extrae y combina información de empresas y sus trabajadores a partir de múltiples tablas en la base <code>xml4</code>. La consulta principal (<code>p1</code>) selecciona datos como <code>NIT</code>, <code>PERIODO</code>, <code>TIPIDE</code>, <code>ESTADO</code>, <code>CODZON</code>, <code>NOMBRE_EMPRESA</code>, y <code>CODCIU</code>, entre otros. La subconsulta interna (<code>p</code>) extrae información relacionada con el período de afiliación y retiro (<code>perafi</code>, <code>perret</code>) y atributos de la empresa (<code>tipemp</code>, <code>tipsoc</code>, <code>nomcom</code>). La subconsulta secundaria (<code>p2</code>) agrega datos sobre el número de trabajadores (<code>NumTrab</code>) y el desglose por género (<code>NumFem</code>, <code>NumMas</code>), permitiendo una vista completa de las características y composición de los trabajadores en cada período.</p>
<p>La consulta final une <code>p1</code> con <code>p2</code> en <code>nit</code> y <code>periodo</code>, creando un conjunto de datos consolidado que permite el análisis detallado de empresas y sus trabajadores en períodos específicos, con un enfoque en la segmentación por género y afiliación.</p>
<div class="highlight"><pre><span></span><code><span class="n">qr_structure</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT</span>
<span class="s1">        p1.nit, p1.periodo, p1.tipide, p1.tipper, p1.estado, p1.divpol as codzon, p1.cod,</span>
<span class="s1">        p1.nombre as calemp, p1.tipapo, p1.perafi, p1.perret, p2.NumTrab, p1.codciu, </span>
<span class="s1">        p2.NumFem, p2.NumMas, p1.tipemp, p1.tipsoc, p1.nomcom, p1.razsoc, p1.codact, </span>
<span class="s1">        p1.fecsis, p1.persis, p1.codest</span>
<span class="s1">    FROM (</span>
<span class="s1">        SELECT</span>
<span class="s1">            p.nit, p.periodo, p.tipide, p.cod, p.tipper, p.estado, p.divpol,</span>
<span class="s1">            p.nombre, p.tipapo, p.codciu, p.tipemp, p.tipsoc, p.nomcom, p.razsoc, </span>
<span class="s1">            p.codact, p.perafi, p.perret, p.fecsis, p.persis, p.codest</span>
<span class="s1">        FROM (</span>
<span class="s1">            SELECT</span>
<span class="s1">                b.nit, b.periodo, b.tipide, b.cod, b.tipper, b.estado, b.divpol,</span>
<span class="s1">                c.perafi, a.nombre, b.tipapo, b.fecret as perret, s.codciu, </span>
<span class="s1">                d.nombre as tipemp, s.tipsoc, s.nomcom, b.razsoc, b.codact, </span>
<span class="s1">                s.fecsis, s.persis, s.codest</span>
<span class="s1">            FROM (</span>
<span class="s1">                SELECT</span>
<span class="s1">                    nit, tipide, CONCAT(tipide, nit) as cod,</span>
<span class="s1">                    periodo, estado, divpol, IF(tipide=7, &#39;J&#39;, &#39;N&#39;) as tipper,</span>
<span class="s1">                    tipapo, razsoc, codact, tipsec,</span>
<span class="s1">                    IF(estado = 2 OR estado = 4, periodo, NULL) as fecret</span>
<span class="s1">                FROM xml4.xml4c085</span>
<span class="s1">                #WHERE nit=&#39;891780093&#39;</span>

<span class="s1">                GROUP BY cod, periodo</span>
<span class="s1">            ) as b</span>
<span class="s1">            LEFT JOIN xml4.xml4b072 as a ON b.tipapo = a.tipapo</span>
<span class="s1">            LEFT JOIN xml4.xml4b001 as d ON b.tipsec = d.tipsec</span>
<span class="s1">            LEFT JOIN (</span>
<span class="s1">                SELECT </span>
<span class="s1">                    CONCAT(</span>
<span class="s1">                        CAST(</span>
<span class="s1">                            CASE</span>
<span class="s1">                                WHEN coddoc = &#39;CC&#39; THEN 1</span>
<span class="s1">                                WHEN coddoc = &#39;CE&#39; THEN 4</span>
<span class="s1">                                WHEN coddoc = &#39;NI&#39; THEN 7</span>
<span class="s1">                                WHEN coddoc = &#39;PA&#39; THEN 6</span>
<span class="s1">                                WHEN coddoc = &#39;RC&#39; THEN 3</span>
<span class="s1">                                ELSE coddoc</span>
<span class="s1">                            END AS CHAR</span>
<span class="s1">                        ),</span>
<span class="s1">                        nit</span>
<span class="s1">                    ) AS cod, codciu, tipsoc, nomcom, fecsis, </span>
<span class="s1">                    CONCAT(SUBSTRING(fecsis, 1, 4), SUBSTRING(fecsis, 6, 2)) as persis, </span>
<span class="s1">                    codest</span>
<span class="s1">                FROM subsidio.subsi02</span>
<span class="s1">                GROUP BY cod</span>
<span class="s1">            ) as s ON b.cod = s.cod</span>
<span class="s1">            LEFT JOIN (</span>
<span class="s1">                SELECT CONCAT(tipide, nit) as cod, MIN(periodo) as perafi </span>
<span class="s1">                FROM xml4.xml4c085 </span>
<span class="s1">                WHERE estado=1 </span>
<span class="s1">                GROUP BY CONCAT(tipide, nit)</span>
<span class="s1">            ) as c ON b.cod = c.cod</span>
<span class="s1">        ) as p</span>
<span class="s1">        WHERE  </span>
<span class="s1">            (</span>
<span class="s1">                CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &lt;= DATE_FORMAT(CURDATE(), &#39;%Y-%m-01&#39;)</span>
<span class="s1">                AND CONCAT(SUBSTRING(perret, 1, 4), &#39;-&#39;, SUBSTRING(perret, 5, 2), &#39;-01&#39;) &gt;= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 18 MONTH), &#39;%Y-%m-01&#39;)</span>
<span class="s1">            ) OR (</span>
<span class="s1">                CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &lt;= DATE_FORMAT(CURDATE(), &#39;%Y-%m-01&#39;)</span>
<span class="s1">                AND perret IS NULL</span>
<span class="s1">            )</span>
<span class="s1">    ) as p1</span>
<span class="s1">    LEFT JOIN (</span>
<span class="s1">        SELECT </span>
<span class="s1">            periodo, nit, COUNT(DISTINCT(CONCAT(coddoc, cedtra))) as NumTrab, </span>
<span class="s1">            SUM(sexfem) as NumFem, SUM(sexmas) as NumMas</span>
<span class="s1">        FROM (</span>
<span class="s1">            SELECT </span>
<span class="s1">                periodo, nit, coddoc, cedtra, </span>
<span class="s1">                IF(tipgen = 2, 1, 0) as sexfem, </span>
<span class="s1">                IF(tipgen = 1, 1, 0) as sexmas </span>
<span class="s1">            FROM xml4.xml4c086 </span>
<span class="s1">            GROUP BY coddoc, cedtra, nit, periodo</span>
<span class="s1">        ) as tra</span>
<span class="s1">        GROUP BY nit, periodo</span>
<span class="s1">    ) as p2 ON p1.nit = p2.nit AND p1.periodo = p2.periodo;</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">}</span>

<span class="n">df_structure</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;LECTURA DE QUERYS&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-30 11:48:51,419 - INFO - LECTURA DE QUERYS
</code></pre></div>

<h3 id="consulta-sql-para-consolidacion-de-datos-de-empresas-con-segmentacion-por-periodo">Consulta SQL para Consolidación de Datos de Empresas con Segmentación por Periodo<a class="headerlink" href="#consulta-sql-para-consolidacion-de-datos-de-empresas-con-segmentacion-por-periodo" title="Permanent link">&para;</a></h3>
<p>Esta consulta en <code>qr_structure2</code> selecciona y agrupa información de empresas en diferentes períodos, consolidando datos de estado de afiliación y características adicionales. La consulta selecciona campos como <code>periodo</code>, <code>tipide</code>, <code>tipper</code>, <code>codzon</code>, <code>codest</code>, y <code>estado</code>, además de columnas derivadas como <code>seRetiro</code>, <code>seAfilio</code>, y <code>nuevo</code> que indican cambios de afiliación por período.</p>
<p>La subconsulta (<code>hh</code>) filtra los registros en un rango de 18 meses desde la fecha actual, generando indicadores sobre si la empresa se retiró o afilió en un período específico. La consulta final agrupa estos datos por <code>periodo</code>, <code>Tipo</code>, <code>cod</code>, y <code>estado</code>, creando una estructura resumida para análisis y segmentación de empresas en función de su estado y afiliación en el Data Warehouse.</p>
<div class="highlight"><pre><span></span><code><span class="n">qr_structure2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT</span>
<span class="s1">        periodo, nit as id, tipide, tipper, MAX(codzon) as codzon,</span>
<span class="s1">        MAX(codest) as codest, Tipo, cod, estado,</span>
<span class="s1">        MAX(seRetiro) as seRetiro, MAX(seAfilio) as seAfilio,  MAX(nuevo) as nuevo,</span>
<span class="s1">        MAX(calsuc) as calsuc, MAX(tipapo) as tipapo,</span>
<span class="s1">        MAX(NumTrab), MAX(codciu) as codciu, MAX(tipemp) as tipemp , MAX(tipsoc) as tipsoc , </span>
<span class="s1">        MAX(nomcom) as nomcom, MAX(razsoc) as razsoc,</span>
<span class="s1">        MAX(NumFem) as NumFem, MAX(NumMas) as NumMas, MAX(codact) as codact, MIN(fecsis) as fecsis</span>
<span class="s1">    FROM (</span>
<span class="s1">        SELECT nit, tipide, tipper, estado, periodo, codzon, codest, cod, &#39;Empresa&#39; as Tipo,</span>
<span class="s1">            calemp as calsuc, tipapo, fecsis, perafi, persis, NumTrab, codciu, NumFem, NumMas, </span>
<span class="s1">            tipemp, tipsoc, nomcom, razsoc, codact,</span>
<span class="s1">            IF(perret = periodo, 1, 0) as seRetiro,</span>
<span class="s1">            IF(perafi = periodo, 1, 0) as seAfilio,</span>
<span class="s1">            IF(periodo = persis, 1, 0) as nuevo</span>
<span class="s1">        FROM dwh.op_EmpresasSubsi02_v2 as p</span>
<span class="s1">        WHERE</span>
<span class="s1">            CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &lt;= DATE_FORMAT(CURDATE(), &#39;%Y-%m-01&#39;)</span>
<span class="s1">            AND CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &gt;= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 18 MONTH), &#39;%Y-%m-01&#39;)</span>
<span class="s1">    ) as hh</span>
<span class="s1">    GROUP BY periodo, Tipo, cod, estado;</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">}</span>

<span class="n">df_structure2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;LECTURA DE QUERYS&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-30 11:48:51,428 - INFO - LECTURA DE QUERYS
</code></pre></div>

<h3 id="conexion-a-bases-de-datos-y-carga-de-tablas">Conexión a Bases de Datos y Carga de Tablas<a class="headerlink" href="#conexion-a-bases-de-datos-y-carga-de-tablas" title="Permanent link">&para;</a></h3>
<p>Este código establece conexiones con dos bases de datos distintas, <em>Minerva</em> y <em>DWH</em>, usando SQLAlchemy para manejar las conexiones y un <code>logger</code> para registrar eventos importantes, como el inicio de las conexiones. Primero, se conecta a la base <em>Minerva</em> utilizando <code>obtener_conexion</code>, y luego carga las consultas definidas en <code>qr_structure</code> en el DataFrame <code>df_structure</code> mediante la función <code>cargar_tablas</code>. Posteriormente, se realiza una conexión similar con la base de datos <em>DWH</em>, donde se ejecutan las consultas definidas en <code>qr_structure2</code> para cargar los datos en <code>df_structure2</code>. Este proceso asegura que los datos de ambas bases se procesen correctamente y permite el registro eficiente de eventos durante las operaciones.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Conexion a base Minerva</span>
<span class="n">motor</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">obtener_conexion</span><span class="p">(</span><span class="s1">&#39;minerva&#39;</span><span class="p">))</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;CONEXION A BASE MINERVA&#39;</span><span class="p">)</span>

<span class="n">cargar_tablas</span><span class="p">(</span><span class="n">motor</span><span class="p">,</span> <span class="n">qr_structure</span><span class="p">,</span> <span class="n">df_structure</span><span class="p">,</span> <span class="n">logger</span><span class="p">)</span>

<span class="c1">#Conexion a base Minerva</span>
<span class="n">motor2</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">obtener_conexion</span><span class="p">(</span><span class="s1">&#39;dwh&#39;</span><span class="p">))</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;CONEXION A BASE DWH&#39;</span><span class="p">)</span>
<span class="n">cargar_tablas</span><span class="p">(</span><span class="n">motor2</span><span class="p">,</span> <span class="n">qr_structure2</span><span class="p">,</span> <span class="n">df_structure2</span><span class="p">,</span> <span class="n">logger</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-30 11:48:51,616 - INFO - CONEXION A BASE MINERVA
2024-10-30 11:48:51,966 - INFO - Cargando query 
2024-10-30 11:49:49,195 - INFO - Cargada query, 565,159 registros finales obtenidos. --- 57.23 seconds ---
2024-10-30 11:49:49,323 - INFO - CARGUE TABLAS DESDE MYSQL --- query --- 57.70 seconds ---
2024-10-30 11:49:49,325 - INFO - CONEXION A BASE DWH
2024-10-30 11:49:49,641 - INFO - Cargando query 
2024-10-30 11:50:02,441 - INFO - Cargada query, 199,034 registros finales obtenidos. --- 12.80 seconds ---
2024-10-30 11:50:02,533 - INFO - CARGUE TABLAS DESDE MYSQL --- query --- 13.21 seconds ---
</code></pre></div>

<h3 id="estandarizacion-y-creacion-de-identificadores-unicos-en-datos-de-empresas">Estandarización y Creación de Identificadores Únicos en Datos de Empresas<a class="headerlink" href="#estandarizacion-y-creacion-de-identificadores-unicos-en-datos-de-empresas" title="Permanent link">&para;</a></h3>
<p>Este código realiza la estandarización de nombres de columnas y la creación de un identificador único <code>ID_AFILIADO</code> en el DataFrame <code>op_sec_EmpresasSubsi02_v2</code>. Primero, utiliza un diccionario (<code>_names</code>) para renombrar las columnas clave con <code>convertir_columnas_mayusculas</code>, asegurando consistencia en los nombres y formatos.</p>
<p>Luego, define una serie de condiciones (<code>conditions</code>) y valores (<code>choices</code>) para crear el prefijo de documento basado en el código <code>CODIGO_DOCUMENTO</code>. La función <code>np.select</code> aplica esta lógica de selección múltiple, asignando a cada tipo de documento su abreviatura correspondiente (por ejemplo, <code>CC</code> para cédula de ciudadanía, <code>TI</code> para tarjeta de identidad). El resultado, <code>DOC_PREFIX</code>, se concatena con <code>ID</code> para formar el campo <code>ID_AFILIADO</code>, eliminando posteriormente la columna auxiliar <code>DOC_PREFIX</code>.</p>
<p>Por último, <code>op_sec_EmpresasSubsi02_v2</code> se reorganiza para incluir columnas seleccionadas, y <code>print(df_standar['PERIODO'].unique())</code> muestra los períodos únicos en el DataFrame, permitiendo validar la consistencia de los datos a través del tiempo.</p>
<div class="highlight"><pre><span></span><code><span class="n">op_EmpresasSubsi02_v2</span> <span class="o">=</span> <span class="n">df_structure</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]</span>
<span class="n">op_sec_EmpresasSubsi02_v2</span> <span class="o">=</span> <span class="n">df_structure2</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]</span>
<span class="n">op_sec_EmpresasSubsi02_v2</span>

<span class="n">_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;tipide&#39;</span><span class="p">:</span> <span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;tipper&#39;</span><span class="p">:</span> <span class="s1">&#39;TIPO_PErSONA&#39;</span><span class="p">,</span>  
    <span class="s1">&#39;codzon&#39;</span><span class="p">:</span> <span class="s1">&#39;Codigo_Zona&#39;</span><span class="p">,</span>             
    <span class="s1">&#39;codest&#39;</span><span class="p">:</span> <span class="s1">&#39;COD_EST_INAC&#39;</span><span class="p">,</span>           
    <span class="s1">&#39;seRetiro&#39;</span><span class="p">:</span> <span class="s1">&#39;se_Retiro&#39;</span><span class="p">,</span>             
    <span class="s1">&#39;seAfilio&#39;</span><span class="p">:</span> <span class="s1">&#39;se_Afilio&#39;</span><span class="p">,</span>       
    <span class="s1">&#39;calsuc&#39;</span><span class="p">:</span> <span class="s1">&#39;Calificacion_Sucursal&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;codciu&#39;</span><span class="p">:</span> <span class="s1">&#39;Codigo_Ciudad&#39;</span><span class="p">,</span>   
    <span class="s1">&#39;fecsis&#39;</span><span class="p">:</span> <span class="s1">&#39;Fecha_Sistema&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;MAX(NumTrab)&#39;</span><span class="p">:</span>  <span class="s1">&#39;NUM_TRAB&#39;</span><span class="p">,</span>
    <span class="s1">&#39;estado&#39;</span> <span class="p">:</span> <span class="s1">&#39;COD_EST_AFIL&#39;</span>
<span class="p">}</span>

<span class="n">df_standar</span> <span class="o">=</span> <span class="n">convertir_columnas_mayusculas</span><span class="p">(</span><span class="n">op_sec_EmpresasSubsi02_v2</span><span class="p">,</span><span class="n">_names</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Definir las condiciones y los valores para la lógica CASE</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">15</span>
<span class="p">]</span>

<span class="c1"># Valores correspondientes a cada condición</span>
<span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;TI&#39;</span><span class="p">,</span> <span class="s1">&#39;RC&#39;</span><span class="p">,</span> <span class="s1">&#39;CE&#39;</span><span class="p">,</span> <span class="s1">&#39;NP&#39;</span><span class="p">,</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="s1">&#39;NI&#39;</span><span class="p">,</span> <span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;PT&#39;</span><span class="p">]</span>

<span class="c1"># Aplicar las condiciones con np.select y crear el prefijo correspondiente</span>
<span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;DOC_PREFIX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">choices</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>

<span class="c1"># Concatenar el prefijo y cedtra para crear la columna ID_AFILIADO</span>
<span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;ID_AFILIADO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;DOC_PREFIX&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># Eliminar la columna auxiliar DOC_PREFIX si no se necesita</span>
<span class="n">df_standar</span> <span class="o">=</span> <span class="n">df_standar</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DOC_PREFIX&#39;</span><span class="p">])</span>

<span class="n">op_sec_EmpresasSubsi02_v2</span> <span class="o">=</span> <span class="n">df_standar</span><span class="p">[[</span>
    <span class="s1">&#39;PERIODO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ID_AFILIADO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ID&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TIPO_PERSONA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CODIGO_ZONA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;COD_EST_INAC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TIPO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;COD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;COD_EST_AFIL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SE_RETIRO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SE_AFILIO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NUEVO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CALIFICACION_SUCURSAL&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TIPAPO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NUM_TRAB&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CODIGO_CIUDAD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TIPEMP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TIPSOC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NOMCOM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RAZSOC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NUMFEM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NUMMAS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CODACT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FECHA_SISTEMA&#39;</span>
    <span class="p">]]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;PERIODO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[&#39;202310&#39; &#39;202311&#39; &#39;202312&#39; &#39;202401&#39; &#39;202402&#39; &#39;202403&#39; &#39;202404&#39; &#39;202309&#39;
 &#39;202407&#39; &#39;202408&#39; &#39;202409&#39; &#39;202304&#39; &#39;202305&#39; &#39;202306&#39; &#39;202307&#39; &#39;202308&#39;
 &#39;202405&#39; &#39;202406&#39;]
</code></pre></div>

<h3 id="almacenamiento-de-datos-en-el-data-warehouse">Almacenamiento de Datos en el Data Warehouse<a class="headerlink" href="#almacenamiento-de-datos-en-el-data-warehouse" title="Permanent link">&para;</a></h3>
<p>En esta última etapa, el código utiliza la función <code>guardar_en_dwh</code> para almacenar los DataFrames <code>op_EmpresasSubsi02_v2</code> y <code>op_sec_EmpresasSubsi02_v2</code> en el Data Warehouse. La primera llamada guarda <code>op_EmpresasSubsi02_v2</code> en una tabla con el mismo nombre en el DWH, y la segunda llamada almacena <code>op_sec_EmpresasSubsi02_v2</code> en la tabla <code>BD_Fact_Historico_Afiliacion_Empresas</code>. Los parámetros <code>multiple=False</code> y <code>if_exists='replace'</code> indican que las tablas se reemplazarán si ya existen y que no se manejarán datos en múltiples bloques, optimizando el proceso de inserción. Esta operación asegura que la información esté disponible y actualizada para futuras consultas o análisis.</p>
<div class="highlight"><pre><span></span><code><span class="n">guardar_en_dwh</span><span class="p">(</span><span class="n">op_EmpresasSubsi02_v2</span><span class="p">,</span> <span class="s1">&#39;op_EmpresasSubsi02_v2&#39;</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">guardar_en_dwh</span><span class="p">(</span><span class="n">op_sec_EmpresasSubsi02_v2</span><span class="p">,</span> <span class="s1">&#39;BD_Fact_Historico_Afiliacion_Empresas&#39;</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-30 11:50:03,089 - INFO - Intentando conexión a la base DWH...
2024-10-30 11:50:03,091 - INFO - Conexión a la base DWH establecida con éxito.
2024-10-30 11:50:03,388 - INFO - Almacenando tabla única en DWH como op_EmpresasSubsi02_v2
2024-10-30 11:51:50,695 - INFO - Tabla almacenada correctamente. 565,159 registros finales obtenidos.
2024-10-30 11:51:51,500 - INFO - ALMACENAMIENTO ---  --- 1.81 minutes ---
2024-10-30 11:51:51,501 - INFO - Finalizando proceso de almacenamiento en DWH.
2024-10-30 11:51:51,503 - INFO - Intentando conexión a la base DWH...
2024-10-30 11:51:51,506 - INFO - Conexión a la base DWH establecida con éxito.
2024-10-30 11:51:51,839 - INFO - Almacenando tabla única en DWH como BD_Fact_Historico_Afiliacion_Empresas
2024-10-30 11:52:26,714 - INFO - Tabla almacenada correctamente. 199,034 registros finales obtenidos.
2024-10-30 11:52:26,925 - INFO - ALMACENAMIENTO ---  --- 35.42 seconds ---
2024-10-30 11:52:26,927 - INFO - Finalizando proceso de almacenamiento en DWH.
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">op_sec_EmpresasSubsi02_v2</span><span class="p">[</span><span class="s1">&#39;PERIODO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>array([&#39;202310&#39;, &#39;202311&#39;, &#39;202312&#39;, &#39;202401&#39;, &#39;202402&#39;, &#39;202403&#39;,
       &#39;202404&#39;, &#39;202309&#39;, &#39;202407&#39;, &#39;202408&#39;, &#39;202409&#39;, &#39;202304&#39;,
       &#39;202305&#39;, &#39;202306&#39;, &#39;202307&#39;, &#39;202308&#39;, &#39;202405&#39;, &#39;202406&#39;],
      dtype=object)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FINAL ETL --- </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> seconds ---&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-30 11:52:26,991 - INFO - FINAL ETL --- 215.59 seconds ---
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../js/init_mermaid.js"></script>
      
    
  </body>
</html>