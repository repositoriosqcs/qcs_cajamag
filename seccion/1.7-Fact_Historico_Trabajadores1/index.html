
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../1.6-Fact_Historico_Afiliacion_Empresas/">
      
      
        <link rel="next" href="../1.7-Fact_Historico_Trabajadores2/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>1.7 Fact Historico Trabajadores1 - Optimización CAJAMAG - Gobierno de Datos</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="#d89717" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#17-fact-historico-trabajadores-1" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Optimización CAJAMAG - Gobierno de Datos" class="md-header__button md-logo" aria-label="Optimización CAJAMAG - Gobierno de Datos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Optimización CAJAMAG - Gobierno de Datos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1.7 Fact Historico Trabajadores1
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Optimización CAJAMAG - Gobierno de Datos" class="md-nav__button md-logo" aria-label="Optimización CAJAMAG - Gobierno de Datos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Optimización CAJAMAG - Gobierno de Datos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INTRODUCCIÓN
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../instalacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INSTALACIÓN Y CONFIGURACIÓN
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../buenaspracticas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BUENAS PRACTICAS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../codigo/funciones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FUNCIONES
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    BODEGAS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            BODEGAS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1. Bodega 1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            1. Bodega 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.1-DimDatosFijos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1 DimDatosFijos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.2-DimCalendarioMensual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2 DimCalendarioMensual
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.3-Dimensiones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3 Dimensiones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.4-Dimensiones_xml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4 Dimensiones xml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.5-FactDatosContacto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5 FactDatosContacto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.6-Fact_Historico_Afiliacion_Empresas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.6 Fact Historico Afiliacion Empresas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    1.7 Fact Historico Trabajadores1
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    1.7 Fact Historico Trabajadores1
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introducción">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagrama-de-secuencia-del-proceso-etl" class="md-nav__link">
    <span class="md-ellipsis">
      Diagrama de Secuencia del Proceso ETL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#etl" class="md-nav__link">
    <span class="md-ellipsis">
      ETL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ETL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importacion-de-librerias-y-funciones" class="md-nav__link">
    <span class="md-ellipsis">
      Importación de librerías y funciones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracion-del-logger-y-comienzo-del-proceso-etl" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración del logger y comienzo del proceso ETL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definicion-y-ejecucion-de-consultas-sql-para-el-analisis-de-trabajadores" class="md-nav__link">
    <span class="md-ellipsis">
      Definición y Ejecución de Consultas SQL para el Análisis de Trabajadores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conexion-a-base-de-datos-y-carga-de-tablas-en-dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      Conexión a Base de Datos y Carga de Tablas en DataFrames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estandarizacion-y-generacion-de-identificadores-en-dataframes-de-trabajadores" class="md-nav__link">
    <span class="md-ellipsis">
      Estandarización y Generación de Identificadores en DataFrames de Trabajadores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#almacenamiento-de-dataframes-de-trabajadores-en-el-data-warehouse" class="md-nav__link">
    <span class="md-ellipsis">
      Almacenamiento de DataFrames de Trabajadores en el Data Warehouse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.7-Fact_Historico_Trabajadores2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.7 Fact Historico Trabajadores2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.8-Fact_HistoricoBeneficiarios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.8 Fact HistoricoBeneficiarios
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.9-Dim_Parametricas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.9 Dim Parametricas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2. Bodega 2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            2. Bodega 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1-FactAportesEmpAfiliadas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 FactAportesEmpAfiliadas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.1-FactHistoricoAportesTotales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1 FactHistoricoAportesTotales
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2-FactHistoricoCuota/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 FactHistoricoCuota
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.3-FactSubsidioVivienda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3 FactSubsidioVivienda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.4-FactFosfec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4 FactFosfec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.2-FactEstadoGiroCuota/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2 FactEstadoGiroCuota
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.5-Fact_HistoricoMoraEmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.5 Fact HistoricoMoraEmp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.6-FactHistoricoANS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.6 FactHistoricoANS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.7-FactHistoricoSubPrescrito/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.7 FactHistoricoSubPrescrito
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.8-FactHistoricoRecobro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.8 FactHistoricoRecobro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.9-FactHistoricoRecuperado/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.9 FactHistoricoRecuperado
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.10-FactIgestion_Mercurio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.10 FactIgestion Mercurio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3. Bodega 3
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            3. Bodega 3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.1-FactTransaccionesVentas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1 FactTransaccionesVentas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    4. Bodega 4
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            4. Bodega 4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.1-FactColegio_fijos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1 FactColegio fijos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.2-FactColegio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2 FactColegio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    5. Bodega 5
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            5. Bodega 5
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.1-FactServicioSocial_Fijos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1 FactServicioSocial Fijos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.2-FactServicioSocial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2 FactServicioSocial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    6. Bodega 6
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            6. Bodega 6
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bloque6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intoduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.1-FactEncuestas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1 FactEncuestas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.2-Fact_Encuesta_afil_empleador/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2 Fact Encuesta afil empleador
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introducción">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagrama-de-secuencia-del-proceso-etl" class="md-nav__link">
    <span class="md-ellipsis">
      Diagrama de Secuencia del Proceso ETL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#etl" class="md-nav__link">
    <span class="md-ellipsis">
      ETL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ETL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importacion-de-librerias-y-funciones" class="md-nav__link">
    <span class="md-ellipsis">
      Importación de librerías y funciones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuracion-del-logger-y-comienzo-del-proceso-etl" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración del logger y comienzo del proceso ETL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definicion-y-ejecucion-de-consultas-sql-para-el-analisis-de-trabajadores" class="md-nav__link">
    <span class="md-ellipsis">
      Definición y Ejecución de Consultas SQL para el Análisis de Trabajadores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conexion-a-base-de-datos-y-carga-de-tablas-en-dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      Conexión a Base de Datos y Carga de Tablas en DataFrames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estandarizacion-y-generacion-de-identificadores-en-dataframes-de-trabajadores" class="md-nav__link">
    <span class="md-ellipsis">
      Estandarización y Generación de Identificadores en DataFrames de Trabajadores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#almacenamiento-de-dataframes-de-trabajadores-en-el-data-warehouse" class="md-nav__link">
    <span class="md-ellipsis">
      Almacenamiento de DataFrames de Trabajadores en el Data Warehouse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="17-fact-historico-trabajadores-1">1.7 Fact Historico Trabajadores 1<a class="headerlink" href="#17-fact-historico-trabajadores-1" title="Permanent link">&para;</a></h1>
<h2 id="introduccion">Introducción<a class="headerlink" href="#introduccion" title="Permanent link">&para;</a></h2>
<p>En este proceso ETL se extraen y transforman datos relacionados con trabajadores para almacenarlos en tablas de hechos en el Data Warehouse (DWH). Las consultas SQL se ejecutan sobre tablas de origen, incluyendo <code>xml4c086</code>, <code>subsi15</code>, y otras fuentes, proporcionando información detallada sobre los trabajadores, como identificadores únicos, documentos, estados civiles, períodos de afiliación y retiro, y detalles sobre categorización y afiliación.</p>
<p>La salida final, <code>BD_Fact_op_Trabajadores_p1</code> y <code>BD_Fact_op_Trabajadores_p2</code>, contiene información consolidada de los trabajadores y sus detalles de afiliación, permitiendo un análisis detallado de la historia laboral de cada afiliado en la base de datos del DWH. Este proceso incluye la estandarización de los nombres de columnas, generación de identificadores únicos y la carga final de los datos en el DWH.</p>
<hr />
<h3 id="diagrama-de-secuencia-del-proceso-etl">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>sequenceDiagram
    title Diagrama de Secuencia del Proceso ETL para Trabajadores
    autonumber
    participant 👤 Usuario
    participant Script as Script ETL
    participant DB as Bases de Datos
    participant DWH as Data Warehouse

    👤 Usuario-&gt;&gt;Script: Solicitar ETL de Trabajadores
    Script-&gt;&gt;DB: Conectar y extraer datos de &lt;br&gt; xml4c086, subsi15
    DB--&gt;&gt;Script: Retornar datos extraídos
    Script-&gt;&gt;Script: Limpiar, estandarizar y transformar los datos
    Script-&gt;&gt;DWH: Cargar datos en BD_Fact_op_Trabajadores_p1 y BD_Fact_op_Trabajadores_p2
    DWH--&gt;&gt;Script: Confirmación de carga exitosa
    Script--&gt;&gt;👤 Usuario: Proceso ETL completado con éxito</code></pre>
<p>Este diagrama describe el flujo del proceso, destacando las fases de limpieza, estandarización y carga en el DWH, asegurando que los datos estén preparados para su análisis en las tablas <code>BD_Fact_op_Trabajadores_p1</code> y <code>BD_Fact_op_Trabajadores_p2</code>.</p>
<h2 id="etl">ETL<a class="headerlink" href="#etl" title="Permanent link">&para;</a></h2>
<h3 id="importacion-de-librerias-y-funciones">Importación de librerías y funciones<a class="headerlink" href="#importacion-de-librerias-y-funciones" title="Permanent link">&para;</a></h3>
<p>Este script configura el entorno para cargar y transformar datos utilizando <code>SQLAlchemy</code>, <code>Pandas</code>, y funciones personalizadas definidas en un archivo externo (<code>Funciones.py</code>). La biblioteca <code>SQLAlchemy</code> permite crear conexiones y manejar transacciones en bases de datos relacionales mediante el uso de <code>create_engine</code>, mientras que <code>Pandas</code> se emplea para la manipulación de datos en formato tabular, ideal para tareas de carga y transformación. Además, la biblioteca <code>logging</code> permite configurar un sistema de registros para monitorear el estado y los errores durante la ejecución. </p>
<p>El script extiende el <code>sys.path</code> para que Python incluya el directorio de las funciones personalizadas, lo que permite importar funciones esenciales como <code>convertir_columnas_mayusculas</code> (para estandarizar nombres de columnas), <code>guardar_en_dwh</code> (para almacenar datos en el Data Warehouse), <code>cargar_tablas</code> (para cargar tablas desde distintas fuentes), <code>obtener_conexion</code> (para establecer una conexión de base de datos), <code>testfunciones</code> (para realizar pruebas), y <code>setup_logger</code> (para configurar los registros). Con esta configuración modular, el script se adapta a flujos de procesamiento de datos dinámicos y escalables, idóneos para operaciones de ETL o análisis de datos.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sa</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1">#Import de modulo funciones</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Agrega el directorio al sys.path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../funciones&#39;</span><span class="p">))</span>

<span class="c1"># Importa las funciones desde el archivo Funciones.py</span>

<span class="kn">from</span> <span class="nn">Funciones</span> <span class="kn">import</span> <span class="n">convertir_columnas_mayusculas</span><span class="p">,</span> <span class="n">guardar_en_dwh</span><span class="p">,</span> <span class="n">cargar_tablas</span><span class="p">,</span> <span class="n">obtener_conexion</span><span class="p">,</span> <span class="n">testfunciones</span><span class="p">,</span> <span class="n">setup_logger</span>
</code></pre></div>
<h3 id="configuracion-del-logger-y-comienzo-del-proceso-etl">Configuración del logger y comienzo del proceso ETL<a class="headerlink" href="#configuracion-del-logger-y-comienzo-del-proceso-etl" title="Permanent link">&para;</a></h3>
<p>En esta celda se configura el logger, que se utiliza para registrar mensajes de información (logging). El logger está configurado para guardar un archivo log con el nombre <code>nombre.log</code>, y en esta etapa, se inicia el proceso ETL, registrando el comienzo del mismo.</p>
<hr />
<div class="highlight"><pre><span></span><code><span class="c1">#---------------------------------------------</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">setup_logger</span><span class="p">(</span><span class="n">log_filename</span><span class="o">=</span><span class="s1">&#39;Trabajadores.log&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>  <span class="c1"># Cambiado a logging.INFO</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">testfunciones</span><span class="p">())</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;COMIENZO ETL&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-28 19:02:25,499 - INFO - Importacion de funciones correcta, 28-10-2024 19:02
2024-10-28 19:02:25,501 - INFO - COMIENZO ETL
</code></pre></div>

<h3 id="definicion-y-ejecucion-de-consultas-sql-para-el-analisis-de-trabajadores">Definición y Ejecución de Consultas SQL para el Análisis de Trabajadores<a class="headerlink" href="#definicion-y-ejecucion-de-consultas-sql-para-el-analisis-de-trabajadores" title="Permanent link">&para;</a></h3>
<p>Este bloque de código define y estructura un conjunto de consultas SQL en el diccionario <code>qr_structure</code>, permitiendo la extracción de datos de diversas fuentes para un análisis detallado de trabajadores. La consulta <code>op_Trabajadores_p1</code> obtiene información detallada sobre los trabajadores, incluyendo su tipo de documento (<code>tipide</code>), identificación (<code>id</code>), periodo de afiliación y retiro (<code>perafi</code>, <code>perret</code>), estado civil (<code>estciv</code>), y otros detalles de afiliación y categorización (<code>codcat</code>, <code>divpol</code>, <code>nivedu</code>, entre otros). Los datos se filtran por un rango de fechas específico y se agrupan mediante <code>cod</code>, lo que asegura que cada trabajador tenga una entrada única por período.</p>
<p>La consulta <code>op_Trabajadores_p2</code> transforma y concatena los tipos de documento (<code>coddoc</code>) y las cédulas (<code>cedtra</code>) para estandarizar el código de trabajador (<code>cod</code>). La estructura <code>dim_names</code> asigna nombres descriptivos a cada consulta, facilitando su posterior almacenamiento en un Data Warehouse bajo identificadores significativos (<code>BD_Fact_op_Trabajadores_p1</code> y <code>BD_Fact_op_Trabajadores_p2</code>). Finalmente, el diccionario <code>df_structure</code> prepara los DataFrames de salida y un registro en el logger indica la lectura de las consultas, permitiendo monitorear la ejecución y garantizar la trazabilidad de las operaciones.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Lista de consultas actualizada con rango de 18 periodos desde la fecha actual</span>
<span class="n">qr_structure</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;op_Trabajadores_p1&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT * FROM</span>
<span class="s2">        (select p1.*, p2.perret, p3.perafi,</span>
<span class="s2">        p4.nombre as calsuc from</span>
<span class="s2">        (Select coddoc as tipide, cedtra as id, CONCAT( coddoc , cedtra ) as cod, periodo, &#39;A&#39; as estado, </span>
<span class="s2">                codcat, divpol as codzon, tipafi, tipgen as sexo, estciv, graesc as nivedu, </span>
<span class="s2">                fecnac, codare as rural  </span>
<span class="s2">            from xml4.xml4c086</span>
<span class="s2">            GROUP BY CONCAT( coddoc , cedtra ), periodo) as p1</span>

<span class="s2">        LEFT JOIN (select CONCAT( coddoc , cedtra ) as cod,</span>
<span class="s2">        IF(MAX(periodo)&lt;(SELECT MAX(periodo) from xml4.xml4c086), MAX(periodo), NULL) as perret </span>
<span class="s2">        from xml4.xml4c086 GROUP BY CONCAT( coddoc , cedtra )) as p2</span>
<span class="s2">        ON p1.cod = p2.cod </span>

<span class="s2">        LEFT JOIN (select CONCAT( coddoc , cedtra ) as cod,</span>
<span class="s2">        MIN(periodo) as perafi from xml4.xml4c086 GROUP BY CONCAT( coddoc , cedtra )) as p3</span>
<span class="s2">        ON p1.cod = p3.cod</span>

<span class="s2">        LEFT JOIN xml4.xml4b006 as p4</span>
<span class="s2">        ON p1.tipafi = p4.tipafi</span>

<span class="s2">        WHERE (CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &lt;= DATE_FORMAT(CURDATE(), &#39;%Y-%m-01&#39;)</span>
<span class="s2">        AND CONCAT(SUBSTRING(perret, 1, 4), &#39;-&#39;, SUBSTRING(perret, 5, 2), &#39;-01&#39;) &gt;= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 18 MONTH), &#39;%Y-%m-01&#39;))</span>
<span class="s2">        OR </span>
<span class="s2">        (CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &lt;= DATE_FORMAT(CURDATE(), &#39;%Y-%m-01&#39;)</span>
<span class="s2">        AND perret IS NULL)) as m</span>
<span class="s2">        WHERE CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &lt;= DATE_FORMAT(CURDATE(), &#39;%Y-%m-01&#39;)</span>
<span class="s2">            AND CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &gt;= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 18 MONTH), &#39;%Y-%m-01&#39;);</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">,</span>

    <span class="s2">&quot;op_Trabajadores_p2&quot;</span><span class="p">:</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        SELECT CONCAT(</span>
<span class="s1">            CAST(</span>
<span class="s1">                CASE </span>
<span class="s1">                    WHEN coddoc = &#39;CC&#39; THEN 1 </span>
<span class="s1">                    WHEN coddoc = &#39;CD&#39; THEN 8</span>
<span class="s1">                    WHEN coddoc = &#39;CE&#39; THEN 4 </span>
<span class="s1">                    WHEN coddoc = &#39;PE&#39; THEN 9            </span>
<span class="s1">                    WHEN coddoc = &#39;PA&#39; THEN 6 </span>
<span class="s1">                    WHEN coddoc = &#39;PT&#39; THEN 15 </span>
<span class="s1">                    WHEN coddoc = &#39;TI&#39; THEN 2</span>
<span class="s1">                    ELSE coddoc </span>
<span class="s1">                END AS CHAR</span>
<span class="s1">            ),</span>
<span class="s1">            cedtra</span>
<span class="s1">        ) AS cod, codciu, codest, fecsis, CONCAT(SUBSTRING(fecsis, 1, 4), SUBSTRING(fecsis, 6, 2)) as persis </span>
<span class="s1">        from subsidio.subsi15 </span>
<span class="s1">        WHERE DATE_FORMAT(CURDATE(), &#39;%Y%m&#39;) &gt;= DATE_FORMAT(fecsis, &#39;%Y%m&#39;) </span>
<span class="s1">            AND DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 18 MONTH), &#39;%Y%m&#39;) &lt;= DATE_FORMAT(fecsis, &#39;%Y%m&#39;)</span>
<span class="s1">        group by cod</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="p">}</span>

<span class="n">dim_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;op_Trabajadores_p1&quot;</span><span class="p">:</span> <span class="s2">&quot;BD_Fact_op_Trabajadores_p1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;op_Trabajadores_p2&quot;</span><span class="p">:</span> <span class="s2">&quot;BD_Fact_op_Trabajadores_p2&quot;</span>
<span class="p">}</span>

<span class="n">df_structure</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;LECTURA DE QUERYS&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qr_structure</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-28 19:02:25,517 - INFO - LECTURA DE QUERYS


{&#39;op_Trabajadores_p1&#39;: &quot;\n        SELECT * FROM\n        (select p1.*, p2.perret, p3.perafi,\n        p4.nombre as calsuc from\n        (Select coddoc as tipide, cedtra as id, CONCAT( coddoc , cedtra ) as cod, periodo, &#39;A&#39; as estado, \n                codcat, divpol as codzon, tipafi, tipgen as sexo, estciv, graesc as nivedu, \n                fecnac, codare as rural  \n            from xml4.xml4c086\n            GROUP BY CONCAT( coddoc , cedtra ), periodo) as p1\n\n        LEFT JOIN (select CONCAT( coddoc , cedtra ) as cod,\n        IF(MAX(periodo)&lt;(SELECT MAX(periodo) from xml4.xml4c086), MAX(periodo), NULL) as perret \n        from xml4.xml4c086 GROUP BY CONCAT( coddoc , cedtra )) as p2\n        ON p1.cod = p2.cod \n\n        LEFT JOIN (select CONCAT( coddoc , cedtra ) as cod,\n        MIN(periodo) as perafi from xml4.xml4c086 GROUP BY CONCAT( coddoc , cedtra )) as p3\n        ON p1.cod = p3.cod\n\n        LEFT JOIN xml4.xml4b006 as p4\n        ON p1.tipafi = p4.tipafi\n\n        WHERE (CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &lt;= DATE_FORMAT(CURDATE(), &#39;%Y-%m-01&#39;)\n        AND CONCAT(SUBSTRING(perret, 1, 4), &#39;-&#39;, SUBSTRING(perret, 5, 2), &#39;-01&#39;) &gt;= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 18 MONTH), &#39;%Y-%m-01&#39;))\n        OR \n        (CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &lt;= DATE_FORMAT(CURDATE(), &#39;%Y-%m-01&#39;)\n        AND perret IS NULL)) as m\n        WHERE CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &lt;= DATE_FORMAT(CURDATE(), &#39;%Y-%m-01&#39;)\n            AND CONCAT(SUBSTRING(periodo, 1, 4), &#39;-&#39;, SUBSTRING(periodo, 5, 2), &#39;-01&#39;) &gt;= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 18 MONTH), &#39;%Y-%m-01&#39;);\n    &quot;, &#39;op_Trabajadores_p2&#39;: &quot;\n        SELECT CONCAT(\n            CAST(\n                CASE \n                    WHEN coddoc = &#39;CC&#39; THEN 1 \n                    WHEN coddoc = &#39;CD&#39; THEN 8\n                    WHEN coddoc = &#39;CE&#39; THEN 4 \n                    WHEN coddoc = &#39;PE&#39; THEN 9            \n                    WHEN coddoc = &#39;PA&#39; THEN 6 \n                    WHEN coddoc = &#39;PT&#39; THEN 15 \n                    WHEN coddoc = &#39;TI&#39; THEN 2\n                    ELSE coddoc \n                END AS CHAR\n            ),\n            cedtra\n        ) AS cod, codciu, codest, fecsis, CONCAT(SUBSTRING(fecsis, 1, 4), SUBSTRING(fecsis, 6, 2)) as persis \n        from subsidio.subsi15 \n        WHERE DATE_FORMAT(CURDATE(), &#39;%Y%m&#39;) &gt;= DATE_FORMAT(fecsis, &#39;%Y%m&#39;) \n            AND DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 18 MONTH), &#39;%Y%m&#39;) &lt;= DATE_FORMAT(fecsis, &#39;%Y%m&#39;)\n        group by cod\n    &quot;}
</code></pre></div>

<h3 id="conexion-a-base-de-datos-y-carga-de-tablas-en-dataframes">Conexión a Base de Datos y Carga de Tablas en DataFrames<a class="headerlink" href="#conexion-a-base-de-datos-y-carga-de-tablas-en-dataframes" title="Permanent link">&para;</a></h3>
<p>Este fragmento de código establece una conexión a la base de datos <strong>Minerva</strong> utilizando SQLAlchemy y la función <code>obtener_conexion</code>, que genera una cadena de conexión basada en los parámetros de esta base. La conexión, representada por <code>motor</code>, facilita el acceso a la base y permite realizar consultas. Tras establecerse, el logger registra la conexión exitosa a la base de datos.</p>
<p>Luego, se invoca <code>cargar_tablas</code>, función encargada de ejecutar cada consulta en <code>qr_structure</code> sobre <code>motor</code> y cargar los resultados en el diccionario <code>df_structure</code>. Así, cada consulta almacena su respectivo DataFrame en <code>df_structure</code>, permitiendo procesar los datos en memoria y prepararlos para análisis o almacenamiento posterior. Este proceso modular optimiza la administración y escalabilidad del flujo de datos.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Conexion a base Minerva</span>
<span class="n">motor</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">obtener_conexion</span><span class="p">(</span><span class="s1">&#39;minerva&#39;</span><span class="p">))</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;CONEXION A BASE MINERVA&#39;</span><span class="p">)</span>

<span class="n">cargar_tablas</span><span class="p">(</span><span class="n">motor</span><span class="p">,</span> <span class="n">qr_structure</span><span class="p">,</span> <span class="n">df_structure</span><span class="p">,</span> <span class="n">logger</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-28 19:02:25,531 - INFO - CONEXION A BASE MINERVA
2024-10-28 19:02:26,062 - INFO - Cargando op_Trabajadores_p1 
2024-10-28 19:04:32,936 - INFO - Cargada op_Trabajadores_p1, 2,456,632 registros finales obtenidos. --- 2.11 minutes ---
2024-10-28 19:04:32,937 - INFO - Cargando op_Trabajadores_p2 
2024-10-28 19:04:35,439 - INFO - Cargada op_Trabajadores_p2, 36,359 registros finales obtenidos. --- 2.50 seconds ---
2024-10-28 19:04:35,528 - INFO - CARGUE TABLAS DESDE MYSQL --- op_Trabajadores_p2 --- 2.17 minutes ---
</code></pre></div>

<h3 id="estandarizacion-y-generacion-de-identificadores-en-dataframes-de-trabajadores">Estandarización y Generación de Identificadores en DataFrames de Trabajadores<a class="headerlink" href="#estandarizacion-y-generacion-de-identificadores-en-dataframes-de-trabajadores" title="Permanent link">&para;</a></h3>
<p>Este código toma los resultados de las consultas <code>op_Trabajadores_p1</code> y <code>op_Trabajadores_p2</code> almacenados en <code>df_structure</code>, estandariza los nombres de sus columnas y genera identificadores únicos para cada trabajador.</p>
<p>Para la consulta <code>op_Trabajadores_p1</code>, se emplea el diccionario <code>_names</code> en la función <code>convertir_columnas_mayusculas</code> para renombrar las columnas y asegurar consistencia en el esquema. Mediante <code>np.select</code>, se aplica una lógica de caso sobre la columna <code>CODIGO_DOCUMENTO</code> que asigna un prefijo (<code>DOC_PREFIX</code>) según el tipo de documento del trabajador. Este prefijo se concatena con la columna <code>ID</code> para crear la columna <code>ID_AFILIADO</code>, un identificador único. Finalmente, se elimina la columna auxiliar <code>DOC_PREFIX</code>, y el DataFrame estandarizado se guarda como <code>df_BD_Fact_op_Trabajadores_p1</code>.</p>
<p>Para la consulta <code>op_Trabajadores_p2</code>, el mismo diccionario <code>_names</code> permite estandarizar las columnas. La estructura resultante se guarda como <code>df_BD_Fact_op_Trabajadores_p2</code>. La conversión garantiza que ambos DataFrames compartan un esquema coherente para su posterior análisis o almacenamiento en el Data Warehouse.</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">df_structure</span><span class="p">[</span><span class="s1">&#39;op_Trabajadores_p1&#39;</span><span class="p">]</span>

<span class="n">_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;tipide&#39;</span><span class="p">:</span> <span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">,</span>                  <span class="c1"># No coincide en _names, se mantiene original</span>
    <span class="s1">&#39;tipper&#39;</span><span class="p">:</span> <span class="s1">&#39;TIPO_PErSONA&#39;</span><span class="p">,</span>                  <span class="c1"># No coincide en _names, se mantiene original</span>
    <span class="s1">&#39;codzon&#39;</span><span class="p">:</span> <span class="s1">&#39;Codigo_Zona&#39;</span><span class="p">,</span>             <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;codest&#39;</span><span class="p">:</span> <span class="s1">&#39;Codigo_Estado&#39;</span><span class="p">,</span>           <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;seRetiro&#39;</span><span class="p">:</span> <span class="s1">&#39;se_Retiro&#39;</span><span class="p">,</span>              <span class="c1"># No coincide en _names, se mantiene original</span>
    <span class="s1">&#39;seAfilio&#39;</span><span class="p">:</span> <span class="s1">&#39;se_Afilio&#39;</span><span class="p">,</span>              <span class="c1"># No coincide en _names, se mantiene original</span>
    <span class="s1">&#39;calsuc&#39;</span><span class="p">:</span> <span class="s1">&#39;Calificacion_Sucursal&#39;</span><span class="p">,</span>   <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;codciu&#39;</span><span class="p">:</span> <span class="s1">&#39;Codigo_Ciudad&#39;</span><span class="p">,</span>           <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;fecsis&#39;</span><span class="p">:</span> <span class="s1">&#39;Fecha_Sistema&#39;</span><span class="p">,</span> <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;MAX(NumTrab)&#39;</span><span class="p">:</span>  <span class="s1">&#39;NUM_TRAB&#39;</span> <span class="c1"># No coincide en _names, se mantiene original</span>
<span class="p">}</span>

<span class="n">df_standar</span> <span class="o">=</span> <span class="n">convertir_columnas_mayusculas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">_names</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Definir las condiciones y los valores para la lógica CASE</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span><span class="p">,</span>
    <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">15</span>
<span class="p">]</span>

<span class="c1"># Valores correspondientes a cada condición</span>
<span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="s1">&#39;TI&#39;</span><span class="p">,</span> <span class="s1">&#39;RC&#39;</span><span class="p">,</span> <span class="s1">&#39;CE&#39;</span><span class="p">,</span> <span class="s1">&#39;NP&#39;</span><span class="p">,</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="s1">&#39;NI&#39;</span><span class="p">,</span> <span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;PT&#39;</span><span class="p">]</span>

<span class="c1"># Aplicar las condiciones con np.select y crear el prefijo correspondiente</span>
<span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;DOC_PREFIX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">choices</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>

<span class="c1"># Concatenar el prefijo y cedtra para crear la columna ID_AFILIADO</span>
<span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;ID_AFILIADO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;DOC_PREFIX&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_standar</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># Eliminar la columna auxiliar DOC_PREFIX si no se necesita</span>
<span class="n">df_BD_Fact_op_Trabajadores_p1</span> <span class="o">=</span> <span class="n">df_standar</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DOC_PREFIX&#39;</span><span class="p">])</span>

<span class="n">df_BD_Fact_op_Trabajadores_p1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[&#39;CODIGO_DOCUMENTO&#39;,
 &#39;ID&#39;,
 &#39;COD&#39;,
 &#39;PERIODO&#39;,
 &#39;ESTADO&#39;,
 &#39;CODCAT&#39;,
 &#39;CODIGO_ZONA&#39;,
 &#39;TIPAFI&#39;,
 &#39;SEXO&#39;,
 &#39;ESTCIV&#39;,
 &#39;NIVEDU&#39;,
 &#39;FECNAC&#39;,
 &#39;RURAL&#39;,
 &#39;PERRET&#39;,
 &#39;PERAFI&#39;,
 &#39;CALIFICACION_SUCURSAL&#39;,
 &#39;ID_AFILIADO&#39;]
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">df_structure</span><span class="p">[</span><span class="s1">&#39;op_Trabajadores_p2&#39;</span><span class="p">]</span>

<span class="n">_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;tipide&#39;</span><span class="p">:</span> <span class="s1">&#39;CODIGO_DOCUMENTO&#39;</span><span class="p">,</span>                  <span class="c1"># No coincide en _names, se mantiene original</span>
    <span class="s1">&#39;tipper&#39;</span><span class="p">:</span> <span class="s1">&#39;TIPO_PErSONA&#39;</span><span class="p">,</span>                  <span class="c1"># No coincide en _names, se mantiene original</span>
    <span class="s1">&#39;codzon&#39;</span><span class="p">:</span> <span class="s1">&#39;Codigo_Zona&#39;</span><span class="p">,</span>             <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;codest&#39;</span><span class="p">:</span> <span class="s1">&#39;Codigo_Estado&#39;</span><span class="p">,</span>           <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;seRetiro&#39;</span><span class="p">:</span> <span class="s1">&#39;se_Retiro&#39;</span><span class="p">,</span>              <span class="c1"># No coincide en _names, se mantiene original</span>
    <span class="s1">&#39;seAfilio&#39;</span><span class="p">:</span> <span class="s1">&#39;se_Afilio&#39;</span><span class="p">,</span>              <span class="c1"># No coincide en _names, se mantiene original</span>
    <span class="s1">&#39;calsuc&#39;</span><span class="p">:</span> <span class="s1">&#39;Calificacion_Sucursal&#39;</span><span class="p">,</span>   <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;codciu&#39;</span><span class="p">:</span> <span class="s1">&#39;Codigo_Ciudad&#39;</span><span class="p">,</span>           <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;fecsis&#39;</span><span class="p">:</span> <span class="s1">&#39;Fecha_Sistema&#39;</span><span class="p">,</span> <span class="c1"># Coincide en _names, se renombra</span>
    <span class="s1">&#39;MAX(NumTrab)&#39;</span><span class="p">:</span>  <span class="s1">&#39;NUM_TRAB&#39;</span> <span class="c1"># No coincide en _names, se mantiene original</span>
<span class="p">}</span>

<span class="n">df_BD_Fact_op_Trabajadores_p2</span> <span class="o">=</span> <span class="n">convertir_columnas_mayusculas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">_names</span><span class="p">)</span>

<span class="n">df_BD_Fact_op_Trabajadores_p2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[&#39;COD&#39;, &#39;CODIGO_CIUDAD&#39;, &#39;CODIGO_ESTADO&#39;, &#39;FECHA_SISTEMA&#39;, &#39;PERSIS&#39;]
</code></pre></div>

<h3 id="almacenamiento-de-dataframes-de-trabajadores-en-el-data-warehouse">Almacenamiento de DataFrames de Trabajadores en el Data Warehouse<a class="headerlink" href="#almacenamiento-de-dataframes-de-trabajadores-en-el-data-warehouse" title="Permanent link">&para;</a></h3>
<p>Estas líneas de código utilizan la función <code>guardar_en_dwh</code> para almacenar los DataFrames <code>df_BD_Fact_op_Trabajadores_p1</code> y <code>df_BD_Fact_op_Trabajadores_p2</code> en el Data Warehouse. Cada DataFrame se guarda en una tabla correspondiente (<code>BD_Fact_op_Trabajadores_p1</code> y <code>BD_Fact_op_Trabajadores_p2</code>) y se configura el parámetro <code>if_exists='replace'</code> para reemplazar cualquier tabla existente con el mismo nombre, asegurando así que los datos estén actualizados. El parámetro <code>multiple=False</code> optimiza la inserción al manejar los datos en un solo bloque. Este proceso asegura que la información estandarizada y enriquecida esté lista para su análisis en el sistema de almacenamiento de datos.</p>
<div class="highlight"><pre><span></span><code><span class="n">guardar_en_dwh</span><span class="p">(</span><span class="n">df_BD_Fact_op_Trabajadores_p1</span><span class="p">,</span> <span class="s1">&#39;BD_Fact_op_Trabajadores_p1&#39;</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>

<span class="n">guardar_en_dwh</span><span class="p">(</span><span class="n">df_BD_Fact_op_Trabajadores_p2</span><span class="p">,</span> <span class="s1">&#39;BD_Fact_op_Trabajadores_p2&#39;</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-28 19:04:36,999 - INFO - Intentando conexión a la base DWH...
2024-10-28 19:04:37,001 - INFO - Conexión a la base DWH establecida con éxito.
2024-10-28 19:04:37,546 - INFO - Almacenando tabla única en DWH como BD_Fact_op_Trabajadores_p1
2024-10-28 19:12:06,086 - INFO - Tabla almacenada correctamente. 2,456,632 registros finales obtenidos.
2024-10-28 19:12:08,794 - INFO - ALMACENAMIENTO ---  --- 7.53 minutes ---
2024-10-28 19:12:08,795 - INFO - Finalizando proceso de almacenamiento en DWH.
2024-10-28 19:12:08,797 - INFO - Intentando conexión a la base DWH...
2024-10-28 19:12:08,799 - INFO - Conexión a la base DWH establecida con éxito.
2024-10-28 19:12:09,357 - INFO - Almacenando tabla única en DWH como BD_Fact_op_Trabajadores_p2
2024-10-28 19:12:13,624 - INFO - Tabla almacenada correctamente. 36,359 registros finales obtenidos.
2024-10-28 19:12:13,735 - INFO - ALMACENAMIENTO ---  --- 4.94 seconds ---
2024-10-28 19:12:13,736 - INFO - Finalizando proceso de almacenamiento en DWH.
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FINAL ETL --- </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> seconds ---&#39;</span><span class="p">)</span>
<span class="n">df_BD_Fact_op_Trabajadores_p1</span><span class="p">[</span><span class="s1">&#39;PERIODO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>2024-10-28 19:13:00,271 - INFO - FINAL ETL --- 634.80 seconds ---





array([&#39;202304&#39;, &#39;202305&#39;, &#39;202306&#39;, &#39;202307&#39;, &#39;202308&#39;, &#39;202309&#39;,
       &#39;202310&#39;, &#39;202311&#39;, &#39;202312&#39;, &#39;202401&#39;, &#39;202402&#39;, &#39;202403&#39;,
       &#39;202404&#39;, &#39;202405&#39;, &#39;202406&#39;, &#39;202407&#39;, &#39;202408&#39;, &#39;202409&#39;],
      dtype=object)
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../js/init_mermaid.js"></script>
      
    
  </body>
</html>